async function getObras(){const e=await fetch("http://54.242.0.71/obras",{method:"GET",redirect:"follow"}),t=await e.text();return JSON.parse(t)}async function cargarObras(){const e=await getObras(),t=document.querySelector(".mainPage_functionsList");t.innerHTML="",e.map(e=>{t.innerHTML+=`\n      <a href="seats.html">\n        <div class="function">\n          <img src="../assets/images/function_prueba.jpg" alt="" />\n          <div>\n              <h2>${e.nombre}</h2>\n              <p>${e.descripcion}</p>\n          </div>\n          <input type="hidden" id="id_obra" value="${e.id}"/>\n        </div>\n      </a>`}),document.querySelectorAll(".function").forEach(e=>{e.addEventListener("click",()=>{const t=e.querySelector("#id_obra").value;localStorage.removeItem("id"),localStorage.setItem("id",t)})})}const botonPagar=document.querySelector(".selected_seats_total > button");cargarObras();let id="";async function getObraById(){const e="http://54.242.0.71/obras/"+(id=localStorage.getItem("id")),t=await fetch(e,{method:"GET",redirect:"follow"});return await t.json()}async function getAsientoPorId(e){const t={id_obra:id=localStorage.getItem("id"),id_asiento:e};var n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),redirect:"follow"};const o=await fetch("http://54.242.0.71/asientos",n);return await o.json()}var asientosSeleccionados=[];async function cargarAsientos(){const e=await getObraById(),t=e[0].asientos,n=document.querySelector(".seats_functionInfo");n.innerHTML="",n.innerHTML+=`\n    <div class="function">\n      <img src="../assets/images/function_prueba.jpg" alt="" />\n      <div>\n        <h2>${e[0].nombre}</h2>\n        <p>${e[0].descripcion}</p>\n      </div>\n      <input type="hidden" id="id_obra" value="${e[0].id}"/>\n    </div>`;const o=document.querySelector(".seats_all_seats_image");t.map(e=>{o.innerHTML+=`<button class="seat" id="${e.numero}" value='${e.precio}'></button>`});let a=0;const i=document.querySelector(".selected_seats_total > h2");o.querySelectorAll(".seat").forEach(e=>{const n=parseInt(e.id,10),o=t.find(e=>e.numero===n);o.ocupado?(e.style.backgroundColor="red",e.disabled=!0):e.addEventListener("click",()=>{const t=parseInt(e.id,10);asientosSeleccionados.includes(t)?(asientosSeleccionados.splice(asientosSeleccionados.indexOf(t),1),e.style.backgroundColor="var(--color-principal)",a-=o.precio):(asientosSeleccionados.push(t),e.style.backgroundColor="#62ae00",a+=o.precio),actualizarLista(),i.innerHTML="Total: "+a+"€"})})}function actualizarLista(){const e=document.querySelector(".selected_seats_list");e.innerHTML="",asientosSeleccionados.forEach(async t=>{const n=await getAsientoPorId(t);e.innerHTML+=`\n      <li class="selected_seats_item">\n        <div>Asiento: ${n.numero}</div>\n        <div>\n          <p>${n.precio+"€"}</p>\n          <button onclick="eliminarAsiento(${n.numero})">X</button>\n        </div>\n      </li>\n    `})}function eliminarAsiento(e){asientosSeleccionados=asientosSeleccionados.filter(t=>t!==e);const t=document.getElementById(e);t&&(t.style.backgroundColor="var(--color-principal)"),actualizarLista()}cargarAsientos();